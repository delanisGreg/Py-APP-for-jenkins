// Run docker build
properties([disableConcurrentBuilds()])

pipeline {
	agent {
		label 'master'
		}
	options {
		buildDiscarder(logRotator(numToKeepStr" '10', artifactNumToKeepStr: '10'))
		timestamps()
		}
	stages {
		stage("Create docker image") {
			steps {
				echo "========= Start building image ========="
				dir ('docker/toolbox') {
					sh 'docker build . '
					}
				}
			}
			
		stage('Push image') {
			docker.withRegistry('https://registry.hub.docker.com') {
				app.push("${env.BUILD_NUMBER}")
				app.push("latest")
			} 
			echo "Trying to Push Docker Build to DockerHub"
		}
	}
}
